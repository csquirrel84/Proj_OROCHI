---
# ==============================================
# OROCHI SECURITY STACK - MAIN CONFIGURATION
# ==============================================

# Base Configuration
orochi_base_path: /opt/orochi
orochi_project_name: orochi

# Network Configuration (3-interface model)
# access_ip    = Analyst-facing (portal, Kibana, TheHive URLs)
# ingestion_ip = Agent-facing (Fleet enrollment, ES log shipping)
# pcap_interface = SPAN/mirror port (Suricata, Zeek, Arkime capture)
orochi_network_name: orochi-network
orochi_server_ip: "{{ access_ip | default(selected_ip) | default('127.0.0.1') }}"
fleet_server_ip: "{{ ingestion_ip | default(access_ip) | default(selected_ip) | default('127.0.0.1') }}"

elasticsearch:
  cluster_name: "{{ cluster_name }}"
  license: "{{ license }}"


# ==============================================
# VERSION PINNING
# ==============================================
elasticsearch_hive_version: "7.17.9"
thehive_version: "4.1.19"
cassandra_version: "4.0"
cyberchef_version: "latest"
mattermost_version: "latest"
postgres_version: "15-alpine"
portal_version: "alpine"
rita_version: "v5.1.1"
arkime_version: "5.8.3"
clickhouse_version: "latest"


# ==============================================
# PORT CONFIGURATION
# ==============================================
ports:
  elasticsearch: 9200
  kibana: 5601
  fleet: 8220
  thehive: 9000
  velociraptor_gui: 8889
  velociraptor_frontend: 8000
  velociraptor_api: 8001
  suricata: 8888
  arkime: 8005
  cyberchef: 8080
  mattermost: 8065
  rita: 8888
  portal_http: 80
  portal_https: 443


# ==============================================
# RESOURCE CONFIGURATION
# ==============================================
resources:
  kibana:
    memory: "2g"
  thehive:
    memory: "2g"
  cassandra:
    memory: "2g"
    heap: "1024M"
    heap_new: "256M"
  elasticsearch:
    memory: "4g"
    heap: "2g"
  elasticsearch_hive:
    memory: "1g"
    heap: "512m"
  suricata:
    memory: "2g"
  mattermost:
    memory: "1g"
  clickhouse:
    memory: "1g"
  rita:
    memory: "512m"

# ==============================================
# SURICATA CONFIGURATION
# ==============================================
suricata_version: "latest"
suricata:
  interface: "{{ pcap_interface | default('eth0') }}"
  home_net: "{{ suricata_home_net | default('192.168.0.0/16') }}"

# ==============================================
# AUTHENTICATION (Override in secrets.yml)
# ==============================================
# Default credentials - CHANGE THESE!
orochi_admin_user: "admin"
orochi_admin_password: "{{ common_password }}"

# Service-specific (inherit from main by default)
elasticsearch_password: "{{ common_password }}"
kibana_password: "{{ common_password }}"
thehive_password: "{{ common_password }}"
velox_user: "{{ orochi_admin_user }}"
velociraptor_password: "{{ common_password }}"
mattermost_password: "{{ common_password }}"
arkime_password: "{{ common_password }}"

  
# ==============================================
# FEATURE FLAGS
# ==============================================
features:
  ssl_enabled: true
  tool_portal: true
  monitoring: true

# ==============================================
# DATA DIRECTORIES
# ==============================================
directories:
  certs: "{{ orochi_base_path }}/certs"
  elasticsearch: "{{ orochi_base_path }}/elasticsearch"
  kibana: "{{ orochi_base_path }}/kibana"
  fleet: "{{ orochi_base_path }}/fleet"
  thehive: "{{ orochi_base_path }}/thehive"
  thehive_es: "{{ orochi_base_path }}/thehive-es"
  cassandra: "{{ orochi_base_path }}/cassandra"
  velociraptor: "{{ orochi_base_path }}/velociraptor"
  suricata: "{{ orochi_base_path }}/suricata"
  arkime: "{{ orochi_base_path }}/arkime"
  mattermost: "{{ orochi_base_path }}/mattermost"
  postgres: "{{ orochi_base_path }}/postgres"
  portal: "{{ orochi_base_path }}/portal"
  rita: "{{ orochi_base_path }}/rita"
  clickhouse: "{{ orochi_base_path }}/clickhouse"
  logs: "{{ orochi_base_path }}/logs"
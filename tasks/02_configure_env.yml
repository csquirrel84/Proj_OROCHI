# tasks/02_configure_env.yml
---
- name: Ensure directory for env file exists
  file:
    path: "{{ env_file | dirname }}"
    state: directory
    mode: '0755'

- name: Check if .env file already exists
  stat:
    path: "{{ env_file }}"
  register: env_stat

- name: Notify about overwriting or creating .env
  debug:
    msg: >
      {{ 'Overwriting existing .env file at ' ~ env_file
         if env_stat.stat.exists
         else 'Creating new .env file at ' ~ env_file }}

- name: Generate .env file (create or overwrite)
  template:
    src: templates/env.j2
    dest: "{{ env_file }}"
    mode: '0600'

- name: Copy docker-compose.yml
  copy:
    src: files/docker-compose.yml
    dest: "{{ compose_file }}"
    mode: '0644'
  when: false  # enable if needed

- name: Display environment file location
  debug:
    msg: "Environment file created at {{ env_file }}"
